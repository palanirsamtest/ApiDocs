MitigationRelationships: &MitigationRelationships
  type: object
  description: The relationships associated with the resource.
  required:
    - risk
    - control
  properties:
    control:
      type: object
      description: |
        Each mitigation has an associated control.
      required:
        - data
      properties:
        data:
          type: object
          description: The data associated with the resource.
          required:
            - id
            - type
          properties:
            id:
              type: string
              description: The ID of the control.
              example: '1'
            type:
              type: string
              description: The classification of the object (`"controls"`).
              example: controls
    risk:
      type: object
      description: |
        Each mitigation has an associated risk.
      required:
        - data
      properties:
        data:
          type: object
          description: The data associated with the resource.
          required:
            - id
            - type
          properties:
            id:
              type: string
              description: The ID of the risk.
              example: '1'
            type:
              type: string
              description: The classification of the object (`"risks"`).
              example: risks

Mitigation: &Mitigation
  type: object
  description: The data associated with the resource.
  required:
    - id
    - type
    - attributes
    - relationships
  properties:
    id: &id
      type: string
      description: The ID of the requested resource.
      example: '1'
    type: &type
      type: string
      description: The type of mitigation (`"mitigations"`).
      example: mitigations
    attributes:
      type: object
      description: The attributes associated with the resource.
      required:
        - weight
      properties:
        weight: &weight
          type: integer
          description: the weight of mitigation. Must be > 0 and less than 100.
          minimum: 0
          maximum: 100
          example: 99
        created_at: &created_at
          type: string
          description: The timestamp identifying when the mitigation was created.
          example: '2019-02-09T13:17:26Z'
          format: date-time
        updated_at: &updated_at
          type: string
          description: The timestamp identifying when the mitigation was last updated.
          example: '2019-02-09T13:17:26Z'
          format: date-time
    relationships: *MitigationRelationships

MitigationUpdateAttribute: &MitigationUpdateAttribute
  type: object
  description: The attributes associated with the resource.
  required:
    - weight
  properties:
    weight: *weight

GetMitigationResponse:
  type: object
  required:
    - data
  properties:
    data: *Mitigation

CreateMitigationRequest:
  type: object
  description: The data associated with the resource.
  required:
    - data
  properties:
    data:
      type: object
      description: The data associated with the resource.
      required:
        - type
        - attributes
        - relationships
      properties:
        type: *type
        attributes: *MitigationUpdateAttribute
        relationships: *MitigationRelationships

UpdateMitigationRequest:
  type: object
  description: The data associated with the resource.
  required:
    - data
  properties:
    data:
      type: object
      description: The data associated with the resource.
      required:
        - id
        - type
        - attributes
      properties:
        id: *id
        type: *type
        attributes: *MitigationUpdateAttribute
