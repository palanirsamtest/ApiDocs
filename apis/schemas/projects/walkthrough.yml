WalkthroughRelationships: &WalkthroughRelationships
  type: object
  description: The relationships associated with the resource.
  required:
    - control
  properties:
    control:
      type: object
      description: The attributes associated with the resource.
      required:
        - data
      properties:
        data:
          type: object
          description: The data associated with the resource.
          required:
            - id
            - type
          properties:
            id:
              type: string
              description: The ID of the control.
              example: '1'
            type:
              type: string
              description: The classification of the object (`"controls"`).
              example: controls

Walkthrough: &Walkthrough
  type: object
  description: The data associated with the resource.
  required:
    - id
    - type
    - relationships
  properties:
    id: &id
      type: string
      description: The ID of the requested resource.
      example: 1
    type: &type
      type: string
      description: The classification of the object (`"walkthroughs"`).
      example: walkthroughs
    attributes:
      type: object
      description: The attributes associated with the resource.
      properties:
        walkthrough_results: &walkthrough_results
          type: string
          description: |
            A description that captures the results of performing the walkthrough.
          maxLength: 524288
          example: '<h1>Heading</h1><p>Walkthrough results description.</p>'
          nullable: true
        created_at: &created_at
          type: string
          description: The timestamp identifying when the walkthrough was created.
          example: '2019-02-09T13:17:26Z'
          format: date-time
        updated_at: &updated_at
          type: string
          description: The timestamp identifying when the walkthrough was updated.
          example: '2019-02-09T13:17:26Z'
          format: date-time
        control_design: &control_design
          type: boolean
          description: |
            A rating that specifies whether the control design passes (`true`) or fails (`false`).

            The exact values for this field (E.g. "Designed Appropriately" / "No Issues" and "Design Failure" / "Issue(s) Noted") depend on the <a href="
            https://help.highbond.com/helpdocs/highbond/en-us/Default.htm#cshid=pm-customize-terms" target="_blank">configuration of the project type</a>.

            `true` maps to the first customizable value (E.g. "Designed Appropriately" / "No Issues") and `false` maps to the second customizable value (E.g.
            "Design Failure" / "Issue(s) Noted") in the project type.
          example: true
          nullable: true
        custom_attributes: &custom_attributes
          type: array
          description: An array of custom attributes defined on the project type used by the project this walkthrough is from. <a href="https://help.highbond.com/helpdocs/highbond/en-us/Default.htm#cshid=pm-project-types" target="_blank">Learn more about project types</a>. Make a PATCH request to modify the value of a custom attribute.
          items:
            type: object
            description: A user defined custom attribute value.
            properties:
              id:
                type: string
                description: The ID of this custom attribute. Optional if term is included.
                example: '42'
              term:
                type: string
                description: The user defined term used to identify this custom attribute. Optional if id is included.
                example: 'Custom Walkthrough Attribute'
              value:
                type: array
                description: The value or values (for multiselect) for this custom attribute.
                example: ['Custom Select Option Text']
                items:
                  type: string
    relationships: *WalkthroughRelationships

WalkthroughsIncludedResources: &WalkthroughsIncludedResources
  type: array
  description: Included resources.
  items:
    type: object
  example:
    - id: 1
      type: 'control'
      attributes:
        title: 'Control Title'
        description: 'Control description'
        control_id: '001'
        owner: 'thomas@sodor.ca'
        frequency: 'Daily'
        control_type: 'Application/System Control'
        prevent_detect: 'Prevent'
        method: 'Management Review'
        status: 'Key Control'
        position: '1'
        created_at: '2019-02-09T13:17:26Z'
        updated_at: '2019-02-09T13:17:26Z'
        custom_attributes:
          - id: 2
            term: 'Custom Control Attribute'
            value: ['Custom Select Option Text']
      relationships:
        objective:
          data:
            id: 1
            type: objectives
        walkthrough:
          data:
            id: 1
            type: walkthroughs
        control_test_plan:
          data:
            id: 1
            type: control_test_plans
        control_tests:
          data:
            - id: 1
              type: control_tests
        mitigations:
          data:
            - id: 1
              type: mitigations
        framework_origin:
          data:
            id: 1
            type: controls
        owner_user:
          data:
            id: '3NQ6XzAUxqJMnAQ7n4KF'
            type: users
    - id: 1
      type: 'objectives'
      attributes:
        title: 'Objective Title'
        reference: 'ITC'
        description: 'Objective description'
        division_department: 'Finance'
        owner: 'thomas@sodor.ca'
        executive_owner: 'henry@sodor.com'
        position: 1
        risk_control_matrix_id: '100'
        walkthrough_summary_id: '200'
        testing_round_1_id: '301'
        testing_round_2_id: '302'
        testing_round_3_id: '303'
        testing_round_4_id: '304'
        created_at: '2019-02-09T13:17:26Z'
        updated_at: '2019-02-09T13:17:26Z'
        custom_attributes:
          - id: 42
            term: 'Custom Objective Attribute'
            value: ['Custom Select Option Text']
        risk_assurance_data:
          inherent_risk: 1.1
          residual_risk: 1.1
          assurance: 0
      relationships:
        project:
          data:
            id: 1
            type: 'projects'
        framework:
          data:
            id: 1
            type: 'frameworks'
        framework_origin:
          data:
            id: 1
            type: 'objectives'
        assigned_user:
          data:
            id: '3NQ6XzAUxqJMnAQ7n4KF'
            type: 'users'

Links: &Links
  type: object
  required:
    - next
    - prev
  properties:
    next:
      type: string
      description: Next page url
      nullable: true
      example: '/api/resource?page[number]=Mg=='
    prev:
      type: string
      description: Previous page url
      nullable: true
      example: null

UpdateWalkthroughRequest:
  type: object
  required:
    - data
  properties:
    data:
      type: object
      description: The data associated with the resource.
      required:
        - id
        - type
        - attributes
        - relationships
      properties:
        id: *id
        type: *type
        attributes:
          type: object
          description: The attributes associated with the resource.
          properties:
            walkthrough_results: *walkthrough_results
            control_design: *control_design
            custom_attributes: *custom_attributes

GetWalkthroughResponse:
  type: object
  required:
    - data
  properties:
    data: *Walkthrough

GetWalkthroughsResponse:
  type: object
  required:
    - data
    - links
  properties:
    data:
      type: array
      items: *Walkthrough
    included: *WalkthroughsIncludedResources
    links: *Links
